# name: test/sql/odbc_win.test
# description: test odbc extension with MS Access on Windows
# group: [odbc]

# Require statement will ensure this test is run with this extension loaded
require odbc

require windows

statement error
from odbc_query('Driver={ODBC Driver 17 for SQL Server};Server=(LocalDB)\MSSQLLocalDB;Database=master;Trusted_Connection=Yes;',
'SELECT 42 AS value');
----
Invalid Error: Failed to connect with connection string: [Microsoft][ODBC Driver 17 for SQL Server]Unable to complete login process due to delay in opening server connection

# Test connection to MS Access database
query I
from odbc_query('Driver={ODBC Driver 17 for SQL Server};Server=(LocalDB)\MSSQLLocalDB;Database=master;Trusted_Connection=Yes;Connection Timeout=90;',
'SELECT 42 AS value');
----
42